<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-general docs-doc-id-lessons-learned">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">Lessons learned | gipfeli.io</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://www.gipfeli.io/general/lessons-learned"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-general-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-general-current"><meta data-rh="true" property="og:title" content="Lessons learned | gipfeli.io"><meta data-rh="true" name="description" content="In this section, we keep track of lessons learned. The goal is to have a list that shows what problems we were facing"><meta data-rh="true" property="og:description" content="In this section, we keep track of lessons learned. The goal is to have a list that shows what problems we were facing"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://www.gipfeli.io/general/lessons-learned"><link data-rh="true" rel="alternate" href="https://www.gipfeli.io/general/lessons-learned" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.gipfeli.io/general/lessons-learned" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/meeting-notes/rss.xml" title="gipfeli.io RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/meeting-notes/atom.xml" title="gipfeli.io Atom Feed"><link rel="stylesheet" href="/assets/css/styles.d2de2517.css">
<link rel="preload" href="/assets/js/runtime~main.13f8656e.js" as="script">
<link rel="preload" href="/assets/js/main.27b01220.js" as="script">
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="gipfeli.io Docs" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="gipfeli.io Docs" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">gipfeli.io</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/general/">General</a><a class="navbar__item navbar__link" href="/docs/">Technical Docs</a><a class="navbar__item navbar__link" href="/meeting-notes">Recent Meeting Notes</a><a class="navbar__item navbar__link" href="/meeting-notes/archive">Meeting Notes Archive</a></div><div class="navbar__items navbar__items--right"><a href="https://api.gipfeli.io/api" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">API Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/gipfeli-io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current,docs-general-current"></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/general/">Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/general/organization">Organization</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/general/definition-of-done">Definition of done</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/general/milestones-planning">Milestones and planning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/general/decision-log">Decision log</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/general/lessons-learned">Lessons learned</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/general/acknowledgements">Acknowledgements</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/general/thesis-documents/abstract">Thesis documents</a></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Lessons learned</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Lessons learned</h1></header><p>In this section, we keep track of lessons learned. The goal is to have a list that shows what problems we were facing
and how we solved them or what implications they had on the project.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="organisation">Organisation<a class="hash-link" href="#organisation" title="Direct link to heading">â€‹</a></h2><ul><li><strong>GitHub project management</strong>: While the GitHub project management board was still in its beta phase when we started our thesis, it actually worked quite well. It still has some minor issues that make it a bit cumbersome to use. One thing we missed was the ability to have issues that affect multiple repositories. For example, an auth related ticket had to be added twice (backend and frontend), even though the issue was related.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="frontend">Frontend<a class="hash-link" href="#frontend" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="nextjs">next.js<a class="hash-link" href="#nextjs" title="Direct link to heading">â€‹</a></h3><ul><li><strong>Dropping next.js in favor of pure React:</strong> The most important lesson that we learned was that next.js was the wrong
tool for what we had in mind. Since we are developing an application that does not require any SEO optimization, the
whole point of having <code>getServerSideProps</code> is void. Apart from that, we had more troubles than benefits in using
next.js in our setup (see above) and we found its documentation to be rather clumsy, especially in regard to the
typescript part. Lots of things that were easily doable with plain React required workarounds. Since one of our goals
was also to have an offline part, we decided it would be best to just use plain React. Because next.js is a wrapper
around React, we were able to create a React app from scratch and move all of our existing code to it, which worked
quite well.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="offline-support">Offline Support<a class="hash-link" href="#offline-support" title="Direct link to heading">â€‹</a></h3><p>We quickly realized that even though PWAs are the newest recommendations for web apps, when your goal is to provide dynamic data when the
application is offline there is no pre-paved way to do this. There are a lot of solutions with fundamentally different approaches out there.
The common consensus is to &quot;find the best way for your application&quot;, as currently, there is no best practice. This would not be that bad if that would be all.
The one thing you really need here as an easy and reliable way to check if your application is connected to the internet or not.
But: There is currently no such way to check if the user is online or offline. You have to make a call to a web server to find out.
The next thing is differing between http status code 500 for an internal server error and http status code 500 when the application has no connection to the
internet. We ended up implementing a workaround and also parsing the error message, so we could find out what status code 500 means (but of course
the error message we get from Safari is different from the one we get from all the other browsers ðŸ˜…). We hope there will be a better way to
check browser connectivity in the future.</p><p>For storing the data in the browser we went with using IndexedDB. As the native api is quite horrible and hard to use we used DexieJS as
a wrapper. Even though DexieJS is extremely nice and easy to use we ran into a multitude of issues, primarily regarding updating the
IndexedDB after application changes. If the IndexedDB on a mobile device was somehow corrupted (e.g. a new version was available, but
it could not upgrade automatically) it was pretty hard to reset the IndexedDB using the provided browser functionality. We had to add
a reset functionality so the user can manually reset if needed.</p><p>Even with all of these things the offline functionality came out fine and makes for a nice addition. But if we&#x27;d ever write an application with
offline functionality again we&#x27;d implement a native app.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="backend">Backend<a class="hash-link" href="#backend" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="nestjs">nest.js<a class="hash-link" href="#nestjs" title="Direct link to heading">â€‹</a></h3><ul><li><strong>Authentication:</strong> Sadly, nest.js does not offer a fully-fledged authentication solution, but just the basics to
implement it yourself. As mentioned
in <a href="/docs/architecture/security/security-authentication-session-management#limitations-known-issues-and-outlook">the authentication docs</a>, this leads to some
security issues. While it is not insecure per se, and while we use existing, well-tested libraries for
security-related features (e.g. <code>bcrypt</code> for hashing, <code>passport.js</code> for strategies), it still is a very hard process
to implement a secure authentication flow (see also our reflection on existing issues in the link above). One very important learning is that these flows should not be implemented lightheartedly and as such, we probably would go for Auth0 or similar providers in the future,
even-though that means additional costs. This is tracked in <a href="https://docs.gipfeli.io/docs/architecture/security/security-authentication-session-management#limitations-known-issues-and-outlook" target="_blank" rel="noopener noreferrer">this issue</a> and something for our next iteration.</li><li><strong>e2e tests:</strong> While we had unit tests from the beginning on, we did not start with e2e tests until one of the last sprints. Our reason for this was that we felt we&#x27;d have to change the tests all the time while quickly iterating in the beginning. However, the amount of configuration required to implement the e2e tests in the end was rather high, which would have been easier (because more gradual) if we had started with e2e tests right from the start. Additionally, some nasty bugs could have been identified much sooner.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="sonarcloud">SonarCloud<a class="hash-link" href="#sonarcloud" title="Direct link to heading">â€‹</a></h2><p>All in all, SonarCloud is a very nice tool that adds quite some value. It forces you to write clean code and it immediately penalizes any shortcuts you might take. However, configuring it is rather difficult and if you want to use it within your CICD pipeline, you cannot rely on the automatic configuration. Furthermore, creating coverage from more than one test run requires the installation of additional packages and implementation of CICD steps to create a single merged coverage report.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="google-cloud-platform">Google Cloud Platform<a class="hash-link" href="#google-cloud-platform" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="general">General<a class="hash-link" href="#general" title="Direct link to heading">â€‹</a></h3><ul><li><strong>Pricing:</strong> While the GCP offerings seem to be very cheap, the costs can mount up quickly. For example, just using
Cloud Run costs do not mirror the fact that you also have to pay for some sort of container registry, which in turn
uses other GCP services such as Cloud Storage. On the other hand, configuring services is not at all straightforward
and each setting may incur further costs. This is especially prevalent in the CloudSQL offerings, since
the <a href="https://cloud.google.com/products/calculator#id=" target="_blank" rel="noopener noreferrer">price calculator</a> does not necessarily mirror each setting
correctly.</li><li><strong>Usage of the Cloud Console:</strong> Especially in terms of IAM settings, the Cloud Console is very difficult and at times
counter-intuitive to use. Our IAM settings are very basic and we kept to the Google Recommendations or standard
settings. However, this part could be optimized, yet would require a significant investment in understanding the inner
workings of the Cloud Platform which goes beyond mere devops skills.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="cloudsql">CloudSQL<a class="hash-link" href="#cloudsql" title="Direct link to heading">â€‹</a></h3><ul><li><strong>Connections:</strong> Connection to CloudSQL instances was not that simple as it is made believe by the many tutorials out
there.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="cloud-run">Cloud Run<a class="hash-link" href="#cloud-run" title="Direct link to heading">â€‹</a></h3><ul><li><strong>Custom domains:</strong> While setting up Cloud Run instance is incredibly simple, configuring a custom domain is rather
difficult and, depending on the service location, requires custom load balancers which in turn incur additional
monthly costs. This was, among others, the reason why we chose to keep our service on Belgian servers.</li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/general/decision-log"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Decision log</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/general/acknowledgements"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Acknowledgements</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#organisation" class="table-of-contents__link toc-highlight">Organisation</a></li><li><a href="#frontend" class="table-of-contents__link toc-highlight">Frontend</a><ul><li><a href="#nextjs" class="table-of-contents__link toc-highlight">next.js</a></li><li><a href="#offline-support" class="table-of-contents__link toc-highlight">Offline Support</a></li></ul></li><li><a href="#backend" class="table-of-contents__link toc-highlight">Backend</a><ul><li><a href="#nestjs" class="table-of-contents__link toc-highlight">nest.js</a></li></ul></li><li><a href="#sonarcloud" class="table-of-contents__link toc-highlight">SonarCloud</a></li><li><a href="#google-cloud-platform" class="table-of-contents__link toc-highlight">Google Cloud Platform</a><ul><li><a href="#general" class="table-of-contents__link toc-highlight">General</a></li><li><a href="#cloudsql" class="table-of-contents__link toc-highlight">CloudSQL</a></li><li><a href="#cloud-run" class="table-of-contents__link toc-highlight">Cloud Run</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 gipfeli.io<br>Built with <a href="https://docusaurus.io/" title="Docusaurus">Docusaurus</a> | Illustrations by <a href="https://undraw.co/" title="Undraw">unDraw</a></div></div></div></footer></div>
<script src="/assets/js/runtime~main.13f8656e.js"></script>
<script src="/assets/js/main.27b01220.js"></script>
</body>
</html>
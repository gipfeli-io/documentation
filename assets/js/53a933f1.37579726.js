"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[2739],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>h});var o=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=o.createContext({}),u=function(e){var t=o.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=u(e.components);return o.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},p=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),p=u(n),h=r,m=p["".concat(l,".").concat(h)]||p[h]||d[h]||a;return n?o.createElement(m,i(i({ref:t},c),{},{components:n})):o.createElement(m,i({ref:t},c))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,i=new Array(a);i[0]=p;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,i[1]=s;for(var u=2;u<a;u++)i[u]=n[u];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}p.displayName="MDXCreateElement"},7179:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>d,frontMatter:()=>a,metadata:()=>s,toc:()=>u});var o=n(7462),r=(n(7294),n(3905));const a={id:"lessons-learned",sidebar_position:7,title:"Lessons learned"},i=void 0,s={unversionedId:"lessons-learned",id:"lessons-learned",title:"Lessons learned",description:"In this section, we keep track of lessons learned. The goal is to have a list that shows what problems we were facing",source:"@site/general/lessons-learned.md",sourceDirName:".",slug:"/lessons-learned",permalink:"/general/lessons-learned",draft:!1,tags:[],version:"current",sidebarPosition:7,frontMatter:{id:"lessons-learned",sidebar_position:7,title:"Lessons learned"},sidebar:"tutorialSidebar",previous:{title:"Decision log",permalink:"/general/decision-log"}},l={},u=[{value:"Organisation",id:"organisation",level:2},{value:"Frontend",id:"frontend",level:2},{value:"next.js",id:"nextjs",level:3},{value:"Backend",id:"backend",level:2},{value:"nest.js",id:"nestjs",level:3},{value:"Google Cloud Platform",id:"google-cloud-platform",level:2},{value:"General",id:"general",level:3},{value:"CloudSQL",id:"cloudsql",level:3},{value:"Cloud Run",id:"cloud-run",level:3}],c={toc:u};function d(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,o.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"In this section, we keep track of lessons learned. The goal is to have a list that shows what problems we were facing\nand how we solved them or what implications they had on the project."),(0,r.kt)("h2",{id:"organisation"},"Organisation"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"TBD"),":")),(0,r.kt)("h2",{id:"frontend"},"Frontend"),(0,r.kt)("h3",{id:"nextjs"},"next.js"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"next-auth:")," We use ",(0,r.kt)("a",{parentName:"li",href:"https://next-auth.js.org/"},"next-auth")," as our authentication framework. It was chosen because of\nits seamless integration into ",(0,r.kt)("inlineCode",{parentName:"li"},"next.js"),". However, we had to realize that it only works as seamlessly as advertised if\nyou use the API capabilities of ",(0,r.kt)("inlineCode",{parentName:"li"},"next.js")," itself. Since we're building our API as a separate service, integration is\nrather difficult and the documentation does not provide much help. Furthermore, since the ",(0,r.kt)("inlineCode",{parentName:"li"},"Credentials")," provider is\ndisencouraged by the authors, a lot of customization has to be made. As we're using ",(0,r.kt)("inlineCode",{parentName:"li"},"JWT")," as authentication strategy,\nit could be simpler to just build the authorization flow from scratch."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Dropping next.js in favor of pure React:")," The most important lesson that we learned was that next.js was the wrong\ntool for what we had in mind. Since we are developing an application that does not require any SEO optimization, the\nwhole point of having ",(0,r.kt)("inlineCode",{parentName:"li"},"getServerSideProps")," is void. Apart from that, we had more troubles than benefits in using\nnext.js in our setup (see above) and we found its documentation to be rather clumsy, especially with regards to the\ntypescript part. Lots of things that were easily doable with plain React required workarounds. Since one of our goals\nwas also to have an offline part, we decided it would be best to just use plain React. Because next.js is a wrapper\naround React, we were able to create a React app from scratch and move all of our existing code to it, which worked\nquite well.")),(0,r.kt)("h2",{id:"backend"},"Backend"),(0,r.kt)("h3",{id:"nestjs"},"nest.js"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Authentication:")," Sadly, nest.js does not offer a fully-fledged authentication solution, but just the basics to\nimplement it yourself. As mentioned\nin ",(0,r.kt)("a",{parentName:"li",href:"../docs/architecture/security/authentication-session-management.md"},"the authentication docs"),", this leads to some\nsecurity issues. While it is not insecure per se, and while we use existing, well-tested libraries for\nsecurity-related features (e.g. ",(0,r.kt)("inlineCode",{parentName:"li"},"bcrypt")," for hashing, ",(0,r.kt)("inlineCode",{parentName:"li"},"passport.js")," for strategies), it still is a very hard process\nto implement a secure authentication flow. As such, we probably would go for Auth0 or similar providers in the future,\neven-though that means additional costs.")),(0,r.kt)("h2",{id:"google-cloud-platform"},"Google Cloud Platform"),(0,r.kt)("h3",{id:"general"},"General"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Pricing:")," While the GCP offerings seem to be very cheap, the costs can mount up quickly. For example, just using\nCloud Run costs do not mirror the fact that you also have to pay for some sort of container registry, which in turn\nuses other GCP services such as Cloud Storage. On the other hand, configuring services is not at all straightforward\nand each setting may incur further costs. This is especially prevalent in the CloudSQL offerings, since\nthe ",(0,r.kt)("a",{parentName:"li",href:"https://cloud.google.com/products/calculator#id="},"price calculator")," does not necessarily mirror each setting\ncorrectly."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Usage of the Cloud Console:")," Especially in terms of IAM settings, the Cloud Console is very difficult and at times\ncounter-intuitive to use. Our IAM settings are very basic and we kept to the Google Recommendations or standard\nsettings. However, this part could be optimized, yet would require a significant investment in understanding the inner\nworkings of the Cloud Platform which goes beyond mere devops skills.")),(0,r.kt)("h3",{id:"cloudsql"},"CloudSQL"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Connections:")," Connection to CloudSQL instances was not that simple as it is made believe by the many tutorials out\nthere.")),(0,r.kt)("h3",{id:"cloud-run"},"Cloud Run"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Custom domains:")," While setting up Cloud Run instance is incredibly simple, configuring a custom domain is rather\ndifficult and, depending on the service location, requires custom load balancers which in turn incur additional\nmonthly costs. This was, among others, the reason why we chose to keep our service on Belgian servers.")))}d.isMDXComponent=!0}}]);
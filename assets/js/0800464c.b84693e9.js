"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[3897],{3905:function(e,t,r){r.d(t,{Zo:function(){return l},kt:function(){return h}});var n=r(67294);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var c=n.createContext({}),u=function(e){var t=n.useContext(c),r=t;return e&&(r="function"==typeof e?e(t):a(a({},t),e)),r},l=function(e){var t=u(e.components);return n.createElement(c.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var r=e.components,o=e.mdxType,i=e.originalType,c=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),d=u(r),h=o,m=d["".concat(c,".").concat(h)]||d[h]||p[h]||i;return r?n.createElement(m,a(a({ref:t},l),{},{components:r})):n.createElement(m,a({ref:t},l))}));function h(e,t){var r=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=r.length,a=new Array(i);a[0]=d;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:o,a[1]=s;for(var u=2;u<i;u++)a[u]=r[u];return n.createElement.apply(null,a)}return n.createElement.apply(null,r)}d.displayName="MDXCreateElement"},24294:function(e,t,r){r.r(t),r.d(t,{assets:function(){return l},contentTitle:function(){return c},default:function(){return h},frontMatter:function(){return s},metadata:function(){return u},toc:function(){return p}});var n=r(87462),o=r(63366),i=(r(67294),r(3905)),a=["components"],s={id:"architecture_api",sidebar_position:2,title:"API Architecture"},c="Api Architecture",u={unversionedId:"architecture/architecture_api",id:"architecture/architecture_api",title:"API Architecture",description:"We are using the out-of-the-box architecture provided by NestJS which consists of a modular approach. Each domain gets its own feature module",source:"@site/docs/architecture/api.md",sourceDirName:"architecture",slug:"/architecture/architecture_api",permalink:"/docs/architecture/architecture_api",draft:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{id:"architecture_api",sidebar_position:2,title:"API Architecture"},sidebar:"tutorialSidebar",previous:{title:"Basics",permalink:"/docs/architecture/basics"},next:{title:"Basics",permalink:"/docs/infrastructure/basics"}},l={},p=[{value:"Structure",id:"structure",level:2},{value:"Modules",id:"modules",level:3},{value:"Utils Module",id:"utils-module",level:4},{value:"Project structure",id:"project-structure",level:4},{value:"TypeORM",id:"typeorm",level:3},{value:"Migrations",id:"migrations",level:4}],d={toc:p};function h(e){var t=e.components,r=(0,o.Z)(e,a);return(0,i.kt)("wrapper",(0,n.Z)({},d,r,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"api-architecture"},"Api Architecture"),(0,i.kt)("p",null,"We are using the out-of-the-box architecture provided by NestJS which consists of a modular approach. Each domain gets its own feature module\nwhich can then be imported by other modules (by default modules are singletons and thus can be shared). Each NestJS application\nhas at least one root module which is the starting point for NestJS to build the internal data structure to resolve relationships between\nmodules, providers and dependencies. Using the recommended architecture gives us a scalable, testable ad loosely coupled application which is also\neasily maintainable. In addition, it allows us to the CLI NestJS provides which makes creating new components (modules, services, controllers etc.) easy and fast."),(0,i.kt)("h2",{id:"structure"},"Structure"),(0,i.kt)("h3",{id:"modules"},"Modules"),(0,i.kt)("p",null,"Each module represents a domain in our application and may consist of the following elements:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"DTOs"),(0,i.kt)("li",{parentName:"ul"},"Interfaces"),(0,i.kt)("li",{parentName:"ul"},"Types"),(0,i.kt)("li",{parentName:"ul"},"Controllers"),(0,i.kt)("li",{parentName:"ul"},"Services"),(0,i.kt)("li",{parentName:"ul"},"Validators"),(0,i.kt)("li",{parentName:"ul"},"Decorators")),(0,i.kt)("p",null,"There are also some more elements you can have in a module. Please refer to the official NestJS documentation for a complete overview: ",(0,i.kt)("a",{parentName:"p",href:"https://docs.nestjs.com"},"NestJS Documentation")),(0,i.kt)("h4",{id:"utils-module"},"Utils Module"),(0,i.kt)("p",null,'For elements which do not have a domain per se (e.g. a service to hash passwords) we created a module called "shared". This module serves as a kind of utils module\nwhere we add helpers we need in different parts of the application.'),(0,i.kt)("h4",{id:"project-structure"},"Project structure"),(0,i.kt)("p",null,"The above principles give us the following project structure (to keep it easily readable we only show the root module (app) and the tour module):"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"gipfeli-api/\n\u251c\u2500\u2500 migrations\n\u251c\u2500\u2500 src/\n\u2502   \u251c\u2500\u2500 app/\n\u2502   \u2502   \u251c\u2500\u2500 app.controller.ts\n\u2502   \u2502   \u251c\u2500\u2500 app.module.ts\n\u2502   \u2502   \u2514\u2500\u2500 app.service.ts\n\u2502   \u251c\u2500\u2500 tour/\n\u2502   \u2502   \u251c\u2500\u2500 dto/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 validators/\n\u2502   \u2502   \u2502   \u2502   \u251c\u2500\u2500 is-point.decorator.spec.ts\n\u2502   \u2502   \u2502   \u2502   \u2514\u2500\u2500 is-point.decorator.ts\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 tour.ts\n\u2502   \u2502   \u251c\u2500\u2500 entities/\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 tour.entity.ts\n\u2502   \u2502   \u251c\u2500\u2500 mocks/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 tour.data.mock.ts\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 tour.repository.mock.ts\n\u2502   \u2502   \u251c\u2500\u2500 tour.controller.spec.ts\n\u2502   \u2502   \u251c\u2500\u2500 tour.controller.ts\n\u2502   \u2502   \u251c\u2500\u2500 tour.module.ts\n\u2502   \u2502   \u251c\u2500\u2500 tour.service.spec.ts\n\u2502   \u2502   \u2514\u2500\u2500 tour.service.ts\n\u2502   \u2514\u2500\u2500 main.ts\n\u2514\u2500\u2500 test\n")),(0,i.kt)("h3",{id:"typeorm"},"TypeORM"),(0,i.kt)("p",null,"Out-of-the-box, TypeORM uses the repository pattern which means that each entity has its own repository. The repositories can be used by using TypeORM's generic\nrepository which provides functionalities to query all entities or execute CRUD operations. As we do not need custom queries at the moment we can use the generic\nrepository which means that there are no repository files listed in our modules. "),(0,i.kt)("h4",{id:"migrations"},"Migrations"),(0,i.kt)("p",null,"The folder containing the migrations TypeORM will use to synchronize entity information to the database is not managed inside the source-folder (src). Because the\nmigration lifecycle is maintained by the TypeORM CLI they should not be a part of source code."),(0,i.kt)("p",null,"To get more information on the recommended architecture using TypeORM and NestJS please refer to the ",(0,i.kt)("a",{parentName:"p",href:"https://docs.nestjs.com/techniques/database#database"},"NestJS documentation"),".\nFor details on TypeORM please check out ",(0,i.kt)("a",{parentName:"p",href:"https://typeorm.io/"},"typeorm.io"),"."))}h.isMDXComponent=!0}}]);
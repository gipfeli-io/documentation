"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[2739],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>p});var o=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=o.createContext({}),u=function(e){var t=o.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},d=function(e){var t=u(e.components);return o.createElement(l.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},h=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,l=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),h=u(n),p=a,f=h["".concat(l,".").concat(p)]||h[p]||c[p]||i;return n?o.createElement(f,r(r({ref:t},d),{},{components:n})):o.createElement(f,r({ref:t},d))}));function p(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,r=new Array(i);r[0]=h;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,r[1]=s;for(var u=2;u<i;u++)r[u]=n[u];return o.createElement.apply(null,r)}return o.createElement.apply(null,n)}h.displayName="MDXCreateElement"},7179:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>c,frontMatter:()=>i,metadata:()=>s,toc:()=>u});var o=n(7462),a=(n(7294),n(3905));const i={id:"lessons-learned",sidebar_position:6,title:"Lessons learned"},r=void 0,s={unversionedId:"lessons-learned",id:"lessons-learned",title:"Lessons learned",description:"In this section, we keep track of lessons learned. The goal is to have a list that shows what problems we were facing",source:"@site/general/lessons-learned.md",sourceDirName:".",slug:"/lessons-learned",permalink:"/general/lessons-learned",draft:!1,tags:[],version:"current",sidebarPosition:6,frontMatter:{id:"lessons-learned",sidebar_position:6,title:"Lessons learned"},sidebar:"tutorialSidebar",previous:{title:"Decision log",permalink:"/general/decision-log"},next:{title:"Abstract",permalink:"/general/thesis-documents/abstract"}},l={},u=[{value:"Organisation",id:"organisation",level:2},{value:"Frontend",id:"frontend",level:2},{value:"next.js",id:"nextjs",level:3},{value:"Offline Support",id:"offline-support",level:3},{value:"Backend",id:"backend",level:2},{value:"nest.js",id:"nestjs",level:3},{value:"SonarCloud",id:"sonarcloud",level:2},{value:"Google Cloud Platform",id:"google-cloud-platform",level:2},{value:"General",id:"general",level:3},{value:"CloudSQL",id:"cloudsql",level:3},{value:"Cloud Run",id:"cloud-run",level:3}],d={toc:u};function c(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",(0,o.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"In this section, we keep track of lessons learned. The goal is to have a list that shows what problems we were facing\nand how we solved them or what implications they had on the project."),(0,a.kt)("h2",{id:"organisation"},"Organisation"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"GitHub project management"),": While the GitHub project management board was still in its beta phase when we started our thesis, it actually worked quite well. It still has some minor issues that make it a bit cumbersome to use. One thing we missed was the ability to have issues that affect multiple repositories. For example, an auth related ticket had to be added twice (backend and frontend), even though the issue was related.")),(0,a.kt)("h2",{id:"frontend"},"Frontend"),(0,a.kt)("h3",{id:"nextjs"},"next.js"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Dropping next.js in favor of pure React:")," The most important lesson that we learned was that next.js was the wrong\ntool for what we had in mind. Since we are developing an application that does not require any SEO optimization, the\nwhole point of having ",(0,a.kt)("inlineCode",{parentName:"li"},"getServerSideProps")," is void. Apart from that, we had more troubles than benefits in using\nnext.js in our setup (see above) and we found its documentation to be rather clumsy, especially in regard to the\ntypescript part. Lots of things that were easily doable with plain React required workarounds. Since one of our goals\nwas also to have an offline part, we decided it would be best to just use plain React. Because next.js is a wrapper\naround React, we were able to create a React app from scratch and move all of our existing code to it, which worked\nquite well.")),(0,a.kt)("h3",{id:"offline-support"},"Offline Support"),(0,a.kt)("p",null,'We quickly realized that even though PWAs are the newest recommendations for web apps, when your goal is to provide dynamic data when the\napplication is offline there is no pre-paved way to do this. There are a lot of solutions with fundamentally different approaches out there.\nThe common consensus is to "find the best way for your application", as currently, there is no best practice. This would not be that bad if that would be all.\nThe one thing you really need here as an easy and reliable way to check if your application is connected to the internet or not.\nBut: There is currently no such way to check if the user is online or offline. You have to make a call to a web server to find out.\nThe next thing is differing between http status code 500 for an internal server error and http status code 500 when the application has no connection to the\ninternet. We ended up implementing a workaround and also parsing the error message, so we could find out what status code 500 means (but of course\nthe error message we get from Safari is different from the one we get from all the other browsers \ud83d\ude05). We hope there will be a better way to\ncheck browser connectivity in the future.'),(0,a.kt)("p",null,"For storing the data in the browser we went with using IndexedDB. As the native api is quite horrible and hard to use we used DexieJS as\na wrapper. Even though DexieJS is extremely nice and easy to use we ran into a multitude of issues, primarily regarding updating the\nIndexedDB after application changes. If the IndexedDB on a mobile device was somehow corrupted (e.g. a new version was available, but\nit could not upgrade automatically) it was pretty hard to reset the IndexedDB using the provided browser functionality. We had to add\na reset functionality so the user can manually reset if needed."),(0,a.kt)("p",null,"Even with all of these things the offline functionality came out fine and makes for a nice addition. But if we'd ever write an application with\noffline functionality again we'd implement a native app."),(0,a.kt)("h2",{id:"backend"},"Backend"),(0,a.kt)("h3",{id:"nestjs"},"nest.js"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Authentication:")," Sadly, nest.js does not offer a fully-fledged authentication solution, but just the basics to\nimplement it yourself. As mentioned\nin ",(0,a.kt)("a",{parentName:"li",href:"../docs/architecture/security/security-authentication-session-management"},"the authentication docs"),", this leads to some\nsecurity issues. While it is not insecure per se, and while we use existing, well-tested libraries for\nsecurity-related features (e.g. ",(0,a.kt)("inlineCode",{parentName:"li"},"bcrypt")," for hashing, ",(0,a.kt)("inlineCode",{parentName:"li"},"passport.js")," for strategies), it still is a very hard process\nto implement a secure authentication flow. As such, we probably would go for Auth0 or similar providers in the future,\neven-though that means additional costs."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"e2e tests:")," While we had unit tests from the beginning on, we did not start with e2e tests until one of the last sprints. Our reason for this was that we felt we'd have to change the tests all the time while quickly iterating in the beginning. However, the amount of configuration required to implement the e2e tests in the end was rather high, which would have been easier (because more gradual) if we had started with e2e tests right from the start. Additionally, some nasty bugs could have been identified much sooner.")),(0,a.kt)("h2",{id:"sonarcloud"},"SonarCloud"),(0,a.kt)("p",null,"All in all, SonarCloud is a very nice tool that adds quite some value. It forces you to write clean code and it immediately penalizes any shortcuts you might take. However, configuring it is rather difficult and if you want to use it within your CICD pipeline, you cannot rely on the automatic configuration. Furthermore, creating coverage from more than one test run requires the installation of additional packages and implementation of CICD steps to create a single merged coverage report."),(0,a.kt)("h2",{id:"google-cloud-platform"},"Google Cloud Platform"),(0,a.kt)("h3",{id:"general"},"General"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Pricing:")," While the GCP offerings seem to be very cheap, the costs can mount up quickly. For example, just using\nCloud Run costs do not mirror the fact that you also have to pay for some sort of container registry, which in turn\nuses other GCP services such as Cloud Storage. On the other hand, configuring services is not at all straightforward\nand each setting may incur further costs. This is especially prevalent in the CloudSQL offerings, since\nthe ",(0,a.kt)("a",{parentName:"li",href:"https://cloud.google.com/products/calculator#id="},"price calculator")," does not necessarily mirror each setting\ncorrectly."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Usage of the Cloud Console:")," Especially in terms of IAM settings, the Cloud Console is very difficult and at times\ncounter-intuitive to use. Our IAM settings are very basic and we kept to the Google Recommendations or standard\nsettings. However, this part could be optimized, yet would require a significant investment in understanding the inner\nworkings of the Cloud Platform which goes beyond mere devops skills.")),(0,a.kt)("h3",{id:"cloudsql"},"CloudSQL"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Connections:")," Connection to CloudSQL instances was not that simple as it is made believe by the many tutorials out\nthere.")),(0,a.kt)("h3",{id:"cloud-run"},"Cloud Run"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Custom domains:")," While setting up Cloud Run instance is incredibly simple, configuring a custom domain is rather\ndifficult and, depending on the service location, requires custom load balancers which in turn incur additional\nmonthly costs. This was, among others, the reason why we chose to keep our service on Belgian servers.")))}c.isMDXComponent=!0}}]);
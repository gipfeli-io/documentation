"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[2638],{4535:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>d,frontMatter:()=>i,metadata:()=>o,toc:()=>u});var n=a(7462),r=(a(7294),a(3905));a(1839);const i={id:"security-general",sidebar_position:1,title:"General"},s=void 0,o={unversionedId:"architecture/security/security-general",id:"architecture/security/security-general",title:"General",description:"Generally, the application consists of protected (as in: you need an account and/or be an administrator) and",source:"@site/docs/architecture/security/general.md",sourceDirName:"architecture/security",slug:"/architecture/security/security-general",permalink:"/docs/architecture/security/security-general",draft:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{id:"security-general",sidebar_position:1,title:"General"},sidebar:"tutorialSidebar",previous:{title:"Frontend Architecture",permalink:"/docs/architecture/frontend-architecture"},next:{title:"Authentication & Session Management",permalink:"/docs/architecture/security/security-authentication-session-management"}},c={},u=[{value:"Infrastructural security",id:"infrastructural-security",level:2},{value:"Limitations and outlook",id:"limitations-and-outlook",level:2}],l={toc:u};function d(e){let{components:t,...a}=e;return(0,r.kt)("wrapper",(0,n.Z)({},l,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"Generally, the application consists of ",(0,r.kt)("strong",{parentName:"p"},"protected")," (as in: you need an account and/or be an administrator) and ",(0,r.kt)("strong",{parentName:"p"},"\nunprotected")," (as in: public access) routes. Therefore, it needs both authentication (who are you) and authorization\n(what can you do) measures. This requires appropriate measures in both frontend and backend. For more information, see\nthe corresponding chapters on ",(0,r.kt)("a",{parentName:"p",href:"/docs/architecture/security/security-authentication-session-management"},"authentication"),"\nand ",(0,r.kt)("a",{parentName:"p",href:"/docs/architecture/security/security-authorization"},"authorization"),"."),(0,r.kt)("h2",{id:"infrastructural-security"},"Infrastructural security"),(0,r.kt)("p",null,"In addition to application-level security outlined above, some additional measures are also taken on the infrastructural\nlevel:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"API Throttling:")," The backend API has a configurable request limit that only allows a certain amount of requests per\nIP per endpoint during a configurable timespan. Additionally, some security-critical routes such as the password reset\nrequest or the login have hard-coded lower limits to limit the possibility of enumeration attacks. The throttling is\nachieved by nest's ",(0,r.kt)("a",{parentName:"li",href:"https://docs.nestjs.com/security/rate-limiting"},"built-in throttler"),"."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"API headers:")," As our backend is a critical part, we use\nthe ",(0,r.kt)("a",{parentName:"li",href:"https://docs.nestjs.com/security/helmet"},"officially recommended helmet plugin")," for nest, which adds and removes\nseveral security-related headers to each request."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"CORS:")," To limit the possibility of sending requests to our API from malicious third-party websites, we\nuse ",(0,r.kt)("a",{parentName:"li",href:"https://docs.nestjs.com/security/cors"},"strict CORS policies"),"."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Hashes:")," The backend has a dedicated ",(0,r.kt)("inlineCode",{parentName:"li"},"CryptoService")," that uses\nthe ",(0,r.kt)("a",{parentName:"li",href:"https://www.npmjs.com/package/bcrypt"},"bcrypt library")," under the hood to generate hashes. The number of hash\nrounds can also be configured which leads to more resistant hashes (at the cost of increasing time for generating a\nhash). All passwords are stored as hashed values only. The same holds true for any tokens (e.g. password reset), which\nare stored as hash in the database and with their cleartext value only sent out once (e.g. during email notification)."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Cloud infrastructure:")," Care has been taken to employ best practices in the cloud. This means that there are, for\nexample, service accounts for handling bucket manipulation which are limited to their bucket only and no other\nservices. The database itself is only accessible via TLS and requires the certificates to be installed on a user's\nsystems. As for secrets, they are encrypted and stored in the GCP Secret Manager. This also holds true for any secrets\nrequired in our GitHub Actions - they use GitHub's secrets.")),(0,r.kt)("admonition",{title:"What about CSRF?",type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"Since we are not using cookie-based authentication, we are not vulnerable to CSRF attacks, because an attacker cannot\nforge a request from a third-party site to our website as no cookies are sent along.")),(0,r.kt)("h2",{id:"limitations-and-outlook"},"Limitations and outlook"),(0,r.kt)("p",null,"Currently, we do not enforce Content Security Policies in the frontend. The backend has them added by the aforementioned\nhelmet plugin, but there is no added benefit to that. CSPs should be enforced in the frontend. Since we're using an\nNGINX instance to serve our frontend, basic plugins can be used. However, fine-tuning CSPs requires a lot of testing and\nneed to be adjusted for different production environments. See ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/gipfeli-io/gipfeli-frontend/issues/196"},"this ticket")," for progress."))}d.isMDXComponent=!0}}]);